#开发文档
1.安装步骤：
* git clone '项目地址' && npm install
* 串口连接程序是C++模块，使用之前需要编译，electron-rebuild包正是为这个目的存在的
* 基本编译环境：node 8.0+、pyton2.7、C++、electron-rebuild 1.5-  electron 1.5- serialport 4.0.7
* 串口通信协议为sr232,crc校验为crc16/modbus规则,可以根据硬件指令直接对硬件进行测试,[modbus规则生成器](https://www*23bei.com/tool-232.html)
* 项目指令
	- npm run rebuild  重新编译串口文件
	- npm run start:firmware  调试模式
	- npm run build:firmware  生产调试
	- npm run pack:firmware_win 打包成window软件
	- npm run pack:firmware_mac 打包成mac软件
2.项目结构:
* newUI:前端界面,基本思路是在newRepair.js中维护一个路由,并管理所有状态和所有页面跳转,第一次写react,状态管理写的比较复杂,不太好追踪,之后如果有时间的话我准备引入dva框架将页面状态重构成模块化
* assets:资源目录,electron渲染进程看起来是前端,实际上要使用node语法,尤其是路径解析这里,
* redux是语言环境,目前支持中文和英文
* 程序有两个入口,index和newRepair,index是bell.ai启动logo,newRepair是主入口,主入口在一秒钟后会自动覆盖index
3.一些tips:
* 主进程IPC只能发送消息,想要广播要使用getFocusWindow().webContents.send,所以如果是有IPC管理的多个子进程通信还不如使用LocalStorage
4.目前的bug
* mac系统下,在启动软件之前连接主控,较大几率无法识别主控,并在后台报Error Resource temporarily unavailable Cannot lock port错误(用户不可见),这是unix设备安全机制造成的.解决方案:拔下主控重新连接
* mac系统下,启动软件后在系统扫描串口且没有扫到的情况下,强行插拔主控,较小几率会造成系统崩溃.解决方案:先开软件,再插主控
* 在已连接一个功能球并不能识别,选择主控降级后,在降级过程<60%之前,如果再接入能够被降级前主控识别的功能球,极大几率造成降级失败,在降级过程>60%后,一定概率造成降级失败.解决方案:只连一个球,并重新降级
* 软件只能识别一个主控的版本,若同时插了两个主控,且对其中一个有过升级或降级操作,此时切换到另一个主控,此时主控版本必定不能识别,一定概率不能识别该主控,若能识别则该主控功能不受影响(仅版本号显示有问题).这样设计的原因参见前两条.解决方案:最好只连接一个主控
5.无法实现的功能